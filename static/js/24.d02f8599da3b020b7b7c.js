webpackJsonp([24],{459:function(n,o,t){function i(n){t(855)}var e=t(1)(t(633),t(951),i,null,null);n.exports=e.exports},573:function(n,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=t(2);t.n(i);o.default={props:{back:{default:!0},title:{default:""},url:{default:"/"},selfMethod:{default:""},act:{default:[]},bgcolor:{default:"#00487C"}},data:function(){return{sheetVisible:!1,actions:[]}},mounted:function(){this.actions=this.act},methods:{geturl:function(){if(""==this.selfMethod)return null!=this.$route.query.redirect?this.$router.push(this.$route.query.redirect):this.$router.push(this.url);this.$emit("leftClick")}},computed:{},components:{actionsheet:i.Actionsheet}}},583:function(n,o,t){o=n.exports=t(455)(!0),o.push([n.i,".topHeaderAct[data-v-98c8ea56]{height:1.04rem}.topHeaderAct .mint-header[data-v-98c8ea56]{color:#fff;font-size:16px;top:-1px;padding:0;z-index:100}.topHeaderAct .mintui-back[data-v-98c8ea56]{line-height:.853333rem;padding:.2rem}.topHeaderAct .mint-button[data-v-98c8ea56]{padding:0 .2rem}","",{version:3,sources:["E:/works/vue/mipos-front/src/components/common/topNavAct.vue"],names:[],mappings:"AACA,+BACE,cAAgB,CACjB,AACD,4CACE,WAAY,AACZ,eAAgB,AAChB,SAAU,AACV,UAAW,AACX,WAAa,CACd,AACD,4CACE,uBAAyB,AACzB,aAAgB,CACjB,AACD,4CACE,eAAkB,CACnB",file:"topNavAct.vue",sourcesContent:["\n.topHeaderAct[data-v-98c8ea56] {\n  height: 1.04rem;\n}\n.topHeaderAct .mint-header[data-v-98c8ea56] {\n  color: #fff;\n  font-size: 16px;\n  top: -1px;\n  padding: 0;\n  z-index: 100;\n}\n.topHeaderAct .mintui-back[data-v-98c8ea56] {\n  line-height: 0.853333rem;\n  padding: 0.2rem;\n}\n.topHeaderAct .mint-button[data-v-98c8ea56] {\n  padding: 0 0.2rem;\n}\n"],sourceRoot:""}])},592:function(n,o,t){var i=t(583);"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t(456)("ff431b8e",i,!0)},602:function(n,o,t){function i(n){t(592)}var e=t(1)(t(573),t(612),i,"data-v-98c8ea56",null);n.exports=e.exports},612:function(n,o){n.exports={render:function(){var n=this,o=n.$createElement,t=n._self._c||o;return t("div",{staticClass:"topHeaderAct"},[t("mt-header",{style:{backgroundColor:n.bgcolor},attrs:{title:n.title,fixed:""}},[t("i",{staticClass:"mintui mintui-back",attrs:{slot:"left"},on:{click:function(o){n.geturl()}},slot:"left"}),n._v(" "),t("div",{staticClass:"mint-header-button is-right",attrs:{slot:"right"},slot:"right"},[t("button",{staticClass:"mint-button mint-button--default mint-button--normal",on:{click:function(o){n.sheetVisible=!0}}},[t("span",{staticClass:"mint-button-icon"},[t("i",{staticClass:"iconfont icon-menu1"})])])])]),n._v(" "),t("actionsheet",{attrs:{actions:n.actions},model:{value:n.sheetVisible,callback:function(o){n.sheetVisible=o},expression:"sheetVisible"}})],1)},staticRenderFns:[]}},629:function(n,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.default={props:{condition:{default:!1},dis:{default:"什么都没有"}},data:function(){return{}},methods:{}}},633:function(n,o,t){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var i=t(2),e=(t.n(i),t(0)),a=t.n(e),s=t(879),r=t.n(s),c=t(602),A=t.n(c);o.default={data:function(){var n=this;return{coupon:null,btnv:!1,empty:!1,edis:"",couponPs:localStorage.ps?JSON.parse(localStorage.ps):{accountLogUser:"",pccode:null,pcname:null},searchSumOption:{pccode:null,userSource:"YPOS",beginDate:a()().format("YYYY-MM-DD"),endDate:a()().add(1,"days").format("YYYY-MM-DD")},hasCount:0,actions:[{name:"历史查询",method:function(){n.nav("/CouponSearch")}}]}},mounted:function(){this.searchSumOption.pccode=this.couponPs.pccode,this.$route.query.couponNo?this.getDetail(this.$route.query.couponNo):(this.empty=!0,this.edis="请先扫描优惠券"),this.getSum()},methods:{nav:function(n){this.$router.push(n+"?redirect=/CouponUse"+(this.$route.query.couponNo?encodeURI("?couponNo="+this.$route.query.couponNo):""))},getDetail:function(n){var o=this;this.$http.post("/pos/posUnion/getCouponByNo",{couponNo:n,pccode:this.couponPs.pccode}).then(function(n){0==n.data.errorCode?(o.empty=!1,n.data.result.length>0?(o.coupon=n.data.result[0],"I"==o.coupon.sta?o.btnv=!0:o.msg("当前优惠券不可核销")):(o.coupon=null,o.empty=!0,o.edis="优惠券不可用",o.btnv=!1,o.msg("没有找到优惠券"))):(o.coupon=null,o.empty=!0,o.edis="优惠券不可用",o.btnv=!1,o.msg(n.data.errorMsg))})},getSum:function(){var n=this;this.$http.post("/pos/posUnion/findCouponSum",this.searchSumOption).then(function(o){if(0==o.data.errorCode){var t=0;if(o.data.result)for(var i=0;i<o.data.result.length;i++)t+=parseInt(o.data.result[i].count);n.hasCount=t}else n.msg(o.data.errorMsg)})},use:function(){var n=this;if(this.coupon.couponPccodeList&&this.coupon.couponPccodeList.length>0){if(!this.couponPs.pccode)return void this.msg("此优惠券需要指定营业点");for(var o=!1,t=0;t<this.coupon.couponPccodeList.length;t++){if(this.coupon.couponPccodeList[t].pccode.split(",").indexOf(this.couponPs.pccode)>=0){o=!0;break}}if(!o)return void this.msg("当前营业点不能核销")}i.MessageBox.confirm("确定核销？").then(function(o){n.$http.post("/pos/posUnion/onlineUseNoAccountCoupon",{couponNo:n.coupon.couponNo,pccode:n.couponPs.pccode,userSource:"YPOS",checkIn:n.coupon.support_checkIn}).then(function(o){0==o.data.errorCode?(n.msg("使用成功"),n.coupon.sta="O",n.btnv=!1,n.getSum()):n.msg(o.data.errorMsg)})})},getbarcode:function(){ScanData(this.scanSucceed,null)},scanSucceed:function(n){null!=n&&""!=n?n.length<60?this.getDetail(n):this.msg("不是数据"):this.msg("扫描数据为空")},niming:function(n){return n&&n.length>4?n.substr(0,2)+"***"+n.substr(n.length-2):n},msg:function(n){t.i(i.Toast)({message:n,position:"bottom",duration:3e3})}},components:{nothing:r.a,topNavAct:A.a}}},764:function(n,o,t){o=n.exports=t(455)(!0),o.push([n.i,".bgnothing[data-v-aaf32384]{text-align:center;margin-top:4.9333rem}.bgnothing img[data-v-aaf32384]{width:2.6667rem}.bgnothing .bgtext[data-v-aaf32384]{text-align:center;font-size:.3733rem;color:#aaa}","",{version:3,sources:["E:/works/vue/mipos-front/src/components/common/nothing.vue"],names:[],mappings:"AACA,4BACE,kBAAmB,AACnB,oBAAsB,CACvB,AACD,gCACE,eAAiB,CAClB,AACD,oCACE,kBAAmB,AACnB,mBAAqB,AACrB,UAAY,CAEb",file:"nothing.vue",sourcesContent:["\n.bgnothing[data-v-aaf32384] {\n  text-align: center;\n  margin-top: 4.9333rem;\n}\n.bgnothing img[data-v-aaf32384] {\n  width: 2.6667rem;\n}\n.bgnothing .bgtext[data-v-aaf32384] {\n  text-align: center;\n  font-size: 0.3733rem;\n  color: #aaa;\n  /*background-color: #fff*/\n}\n"],sourceRoot:""}])},773:function(n,o,t){o=n.exports=t(455)(!0),o.push([n.i,".couponUse .warp{margin:10px auto;background:#f6f8f9}.couponUse .warp .orderSta{background-color:#f6f8f9;height:32px;line-height:26px;color:#333}.couponUse .warp .orderSta .Num{float:left;margin-left:8px}.couponUse .warp .orderSta .sta{float:right;margin-right:8px}.couponUse .warp .infoList{margin:0 10px;background:#fff;-webkit-box-shadow:0 -2px 20px rgba(0,0,0,.15);box-shadow:0 -2px 20px rgba(0,0,0,.15);border-radius:4px}.couponUse .warp .infoList .info{padding:10px 0}.couponUse .warp .infoList .info .infoContent{margin:0 20px;padding:10px 0;clear:both}.couponUse .warp .infoList .info .infoContent .p100{clear:both;width:100%!important}.couponUse .warp .infoList .info .infoContent li{margin:2px auto;line-height:20px;text-align:left}.couponUse .warp .infoList .info .infoContent li .infoVal{margin-left:8px}.couponUse .warp .infoList .info .infoContent li .infoVal a{color:#000}.couponUse .warp .infoList .info .infoContent li .paiF{height:32px;width:70px;float:right;text-align:center;line-height:32px;background-color:#f4f4f4;position:relative;top:-15px;border:1px solid #ddd;border-radius:4px}.couponUse .warp .infoList .info .infoContent.twocol{overflow:hidden}.couponUse .warp .infoList .info .infoContent.twocol li{width:50%;float:left}.couponUse .fixL{width:78.7%;margin-top:2rem;display:inline-block}.couponUse .fixL ul{margin-top:.4rem;margin-bottom:.4rem}.couponUse .fixL ul li{width:47.2%;height:1.2rem;background:#ff8902;border-radius:.1867rem;text-align:center;line-height:1.2rem;display:inline-block;margin-right:.1333rem;color:#fff}.couponUse .fixL ul .p100{width:100%}.couponUse .fsti{color:#fff;font-weight:700;font-size:16px;border-radius:12px;display:inline-block;width:22px;height:22px;text-align:center;background:#646f83;vertical-align:middle;line-height:22px}","",{version:3,sources:["E:/works/vue/mipos-front/src/components/pages/CouponUse.vue"],names:[],mappings:"AACA,iBACE,iBAAkB,AAClB,kBAAoB,CACrB,AACD,2BACE,yBAA0B,AAC1B,YAAa,AACb,iBAAkB,AAClB,UAAY,CACb,AACD,gCACE,WAAY,AACZ,eAAiB,CAClB,AACD,gCACE,YAAa,AACb,gBAAkB,CACnB,AACD,2BACE,cAAe,AACf,gBAAiB,AACjB,+CAAoD,AAC5C,uCAA4C,AACpD,iBAAmB,CACpB,AACD,iCACE,cAAgB,CACjB,AACD,8CACE,cAAe,AACf,eAAgB,AAChB,UAAY,CACb,AACD,oDACE,WAAY,AACZ,oBAAuB,CACxB,AACD,iDACE,gBAAiB,AACjB,iBAAkB,AAClB,eAAiB,CAClB,AACD,0DACE,eAAiB,CAClB,AACD,4DACE,UAAY,CACb,AACD,uDACE,YAAa,AACb,WAAY,AACZ,YAAa,AACb,kBAAmB,AACnB,iBAAkB,AAClB,yBAA0B,AAC1B,kBAAmB,AACnB,UAAW,AACX,sBAAuB,AACvB,iBAAmB,CACpB,AACD,qDACE,eAAiB,CAClB,AACD,wDACE,UAAW,AACX,UAAY,CACb,AACD,iBACE,YAAa,AACb,gBAAiB,AACjB,oBAAsB,CACvB,AACD,oBACE,iBAAmB,AACnB,mBAAsB,CACvB,AACD,uBACE,YAAa,AACb,cAAe,AACf,mBAAoB,AACpB,uBAAyB,AACzB,kBAAmB,AACnB,mBAAoB,AACpB,qBAAsB,AACtB,sBAAwB,AACxB,UAAY,CACb,AACD,0BACE,UAAY,CACb,AACD,iBACE,WAAe,AACf,gBAAkB,AAClB,eAAgB,AAChB,mBAAoB,AACpB,qBAAsB,AACtB,WAAY,AACZ,YAAa,AACb,kBAAmB,AACnB,mBAAoB,AACpB,sBAAuB,AACvB,gBAAkB,CACnB",file:"CouponUse.vue",sourcesContent:["\n.couponUse .warp {\n  margin: 10px auto;\n  background: #F6F8F9;\n}\n.couponUse .warp .orderSta {\n  background-color: #F6F8F9;\n  height: 32px;\n  line-height: 26px;\n  color: #333;\n}\n.couponUse .warp .orderSta .Num {\n  float: left;\n  margin-left: 8px;\n}\n.couponUse .warp .orderSta .sta {\n  float: right;\n  margin-right: 8px;\n}\n.couponUse .warp .infoList {\n  margin: 0 10px;\n  background: #fff;\n  -webkit-box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.15);\n          box-shadow: 0 -2px 20px rgba(0, 0, 0, 0.15);\n  border-radius: 4px;\n}\n.couponUse .warp .infoList .info {\n  padding: 10px 0;\n}\n.couponUse .warp .infoList .info .infoContent {\n  margin: 0 20px;\n  padding: 10px 0;\n  clear: both;\n}\n.couponUse .warp .infoList .info .infoContent .p100 {\n  clear: both;\n  width: 100% !important;\n}\n.couponUse .warp .infoList .info .infoContent li {\n  margin: 2px auto;\n  line-height: 20px;\n  text-align: left;\n}\n.couponUse .warp .infoList .info .infoContent li .infoVal {\n  margin-left: 8px;\n}\n.couponUse .warp .infoList .info .infoContent li .infoVal a {\n  color: #000;\n}\n.couponUse .warp .infoList .info .infoContent li .paiF {\n  height: 32px;\n  width: 70px;\n  float: right;\n  text-align: center;\n  line-height: 32px;\n  background-color: #f4f4f4;\n  position: relative;\n  top: -15px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n}\n.couponUse .warp .infoList .info .infoContent.twocol {\n  overflow: hidden;\n}\n.couponUse .warp .infoList .info .infoContent.twocol li {\n  width: 50%;\n  float: left;\n}\n.couponUse .fixL {\n  width: 78.7%;\n  margin-top: 2rem;\n  display: inline-block;\n}\n.couponUse .fixL ul {\n  margin-top: 0.4rem;\n  margin-bottom: 0.4rem;\n}\n.couponUse .fixL ul li {\n  width: 47.2%;\n  height: 1.2rem;\n  background: #ff8902;\n  border-radius: 0.1867rem;\n  text-align: center;\n  line-height: 1.2rem;\n  display: inline-block;\n  margin-right: 0.1333rem;\n  color: #fff;\n}\n.couponUse .fixL ul .p100 {\n  width: 100%;\n}\n.couponUse .fsti {\n  color: #FFFFFF;\n  font-weight: bold;\n  font-size: 16px;\n  border-radius: 12px;\n  display: inline-block;\n  width: 22px;\n  height: 22px;\n  text-align: center;\n  background: #646F83;\n  vertical-align: middle;\n  line-height: 22px;\n}\n"],sourceRoot:""}])},846:function(n,o,t){var i=t(764);"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t(456)("b83aa86e",i,!0)},855:function(n,o,t){var i=t(773);"string"==typeof i&&(i=[[n.i,i,""]]),i.locals&&(n.exports=i.locals);t(456)("4d6c4b17",i,!0)},879:function(n,o,t){function i(n){t(846)}var e=t(1)(t(629),t(942),i,"data-v-aaf32384",null);n.exports=e.exports},942:function(n,o,t){n.exports={render:function(){var n=this,o=n.$createElement,i=n._self._c||o;return n.condition?i("div",{staticClass:"bgnothing"},[i("img",{attrs:{src:t(4),alt:""}}),n._v(" "),i("p",{staticClass:"bgtext"},[n._v(n._s(n.dis))])]):n._e()},staticRenderFns:[]}},951:function(n,o){n.exports={render:function(){var n=this,o=n.$createElement,t=n._self._c||o;return t("div",{staticClass:"couponUse"},[t("topNavAct",{attrs:{title:"卡券核销",url:"/",act:n.actions}}),n._v(" "),t("div",{staticClass:"warp"},[t("div",{staticClass:"orderSta clearfix"},[t("div",{staticClass:"Num"},[n._v("营业点：\r\n                "),t("span",{staticStyle:{color:"red"}},[n._v(n._s(n.couponPs.pcname?n.couponPs.pcname:"全店"))])]),n._v(" "),t("div",{staticClass:"sta"},[n._v("本日累计：\r\n                "),t("span",{staticStyle:{color:"red"}},[n._v(n._s(n.hasCount))]),n._v(" 条\r\n            ")])]),n._v(" "),n.coupon?t("div",{staticClass:"infoList"},[t("div",{staticClass:"info"},[t("ul",{staticClass:"infoContent twocol"},[t("li",{staticStyle:{width:"70%"}},[n._v("券号:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.couponNo))])]),n._v(" "),t("li",{staticStyle:{width:"30%"}},[n._v("状态:\r\n                        "),t("span",{staticClass:"infoVal fsti"},[n._v(n._s(n.coupon.sta))])]),n._v(" "),t("li",[n._v("名称:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.couponName))])]),n._v(" "),t("li",[n._v("代码:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.couponCode))])]),n._v(" "),t("li",[n._v("类别:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.couponTyDes))])]),n._v(" "),t("li",[n._v("会员卡:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.niming(n.coupon.cardNo)))])]),n._v(" "),t("li",{staticStyle:{color:"red"}},[n._v("面值:\r\n                        "),"RF"==n.coupon.couponType?t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.presentValue)+"折")]):t("span",{staticClass:"infoVal"},[n._v("￥"+n._s(n.coupon.presentValue))])]),n._v(" "),t("li",{staticStyle:{color:"red"}},[n._v("入账:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.support_checkIn))])]),n._v(" "),t("li",[n._v("有效日期:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.validFromDate))])]),n._v(" "),t("li",[n._v("截止日期:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(" "+n._s(n.coupon.validToDate))])]),n._v(" "),t("li",[n._v("适用日期:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.hotelDateSet))])]),n._v(" "),t("li",{staticClass:"p100"},[n._v("适用营业点:\r\n                        "),n.coupon.couponPccodeList?t("span",{staticClass:"infoVal"},[n._l(n.coupon.couponPccodeList,function(o,t){return[t>0?[n._v(",")]:n._e(),n._v("\r\n                             "+n._s(o.pccode)+"\r\n                             ")]})],2):n._e()]),n._v(" "),t("li",{staticClass:"p100"},[n._v("描述:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.couponDes))])]),n._v(" "),t("li",{staticClass:"p100"},[n._v("备注:\r\n                        "),t("span",{staticClass:"infoVal"},[n._v(n._s(n.coupon.remark))])])])])]):n._e()]),n._v(" "),t("nothing",{attrs:{condition:n.empty,dis:n.edis}}),n._v(" "),t("div",{staticClass:"fixL"},[t("ul",[t("li",{class:{p100:!n.btnv},on:{click:n.getbarcode}},[n._v("扫码")]),n._v(" "),n.btnv?t("li",{on:{click:n.use}},[n._v("核销")]):n._e()])])],1)},staticRenderFns:[]}}});
//# sourceMappingURL=24.d02f8599da3b020b7b7c.js.map